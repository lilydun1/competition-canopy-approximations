run_simulation(path = combinations_WD0$path[i])
}
combinations_WD1 <- combinations_WD %>%
filter(WD == "1")
for(i in 1:nrow(combinations_WD1)) {
create_simulation(path = combinations_WD1$path[i], template = "template_WD1", h_mn = combinations_WD1$H[i], h_cv = combinations_WD1$V[i],
LAI = combinations_WD1$L[i], ft_h = combinations_WD1$F[i])
}
for(i in 1:nrow(combinations_WD1)) {
run_simulation(path = combinations_WD1$path[i])
}
combinations_WD2 <- combinations_WD %>%
filter(WD == "2")
for(i in 1:nrow(combinations_WD2)) {
create_simulation(path = combinations_WD2$path[i], template = "template_WD2", h_mn = combinations_WD2$H[i], h_cv = combinations_WD2$V[i],
LAI = combinations_WD2$L[i], ft_h = combinations_WD2$F[i])
}
for(i in 1:nrow(combinations_WD2)) {
run_simulation(path = combinations_WD2$path[i])
}
combinations_WD3 <- combinations_WD %>%
filter(WD == "3")
for(i in 1:nrow(combinations_WD3)) {
create_simulation(path = combinations_WD3$path[i], template = "template_WD3", h_mn = combinations_WD3$H[i], h_cv = combinations_WD3$V[i],
LAI = combinations_WD3$L[i], ft_h = combinations_WD3$F[i])
}
for(i in 1:nrow(combinations_WD3)) {
run_simulation(path = combinations_WD3$path[i])
}
combinations_WD4 <- combinations_WD %>%
filter(WD == "4")
for(i in 1:nrow(combinations_WD4)) {
create_simulation(path = combinations_WD4$path[i], template = "template_WD4", h_mn = combinations_WD4$H[i], h_cv = combinations_WD4$V[i],
LAI = combinations_WD4$L[i], ft_h = combinations_WD4$F[i])
}
for(i in 1:nrow(combinations_WD4)) {
run_simulation(path = combinations_WD4$path[i])
}
output_WD <- combinations_WD$path %>%
purrr:: map_df(load_output)
output_combined_WD <- combinations_WD %>%
left_join(output_WD, by = "path")
output_combined_WD %>%
select(F, totPs, H, V, L, WD) %>%
ggplot(aes(F, totPs)) +
geom_point(aes(colour = as.factor(WD))) +
geom_line(aes(colour = as.factor(WD))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "photosynthesis", x = "FT height", y = "Gross photosynthesis", colour = "Wet or Dry")
#wet and dry
H <- c(15)
V <- c(0.10, 0.25)
L <- c(2.916, 4.402, 5.485)
F <- c(1.99, 1.50, 1.00, 0.50, 0.01)
WD <- c(0, 1, 2, 3, 4)
combinations_WD <- expand_grid(H, V, L, F, WD) %>%
mutate(path = sprintf("simulations_WD/H%s_V%s_L%s_F%s_WD%s", H, V, L, F, WD))
combinations_WD0 <- combinations_WD %>%
filter(WD == "0")
for(i in 1:nrow(combinations_WD0)) {
create_simulation(path = combinations_WD0$path[i], template = "template_WD0", h_mn = combinations_WD0$H[i], h_cv = combinations_WD0$V[i],
LAI = combinations_WD0$L[i], ft_h = combinations_WD0$F[i])
}
for(i in 1:nrow(combinations_WD0)) {
run_simulation(path = combinations_WD0$path[i])
}
combinations_WD1 <- combinations_WD %>%
filter(WD == "1")
for(i in 1:nrow(combinations_WD1)) {
create_simulation(path = combinations_WD1$path[i], template = "template_WD1", h_mn = combinations_WD1$H[i], h_cv = combinations_WD1$V[i],
LAI = combinations_WD1$L[i], ft_h = combinations_WD1$F[i])
}
for(i in 1:nrow(combinations_WD1)) {
run_simulation(path = combinations_WD1$path[i])
}
combinations_WD2 <- combinations_WD %>%
filter(WD == "2")
for(i in 1:nrow(combinations_WD2)) {
create_simulation(path = combinations_WD2$path[i], template = "template_WD2", h_mn = combinations_WD2$H[i], h_cv = combinations_WD2$V[i],
LAI = combinations_WD2$L[i], ft_h = combinations_WD2$F[i])
}
for(i in 1:nrow(combinations_WD2)) {
run_simulation(path = combinations_WD2$path[i])
}
combinations_WD3 <- combinations_WD %>%
filter(WD == "3")
for(i in 1:nrow(combinations_WD3)) {
create_simulation(path = combinations_WD3$path[i], template = "template_WD3", h_mn = combinations_WD3$H[i], h_cv = combinations_WD3$V[i],
LAI = combinations_WD3$L[i], ft_h = combinations_WD3$F[i])
}
for(i in 1:nrow(combinations_WD3)) {
run_simulation(path = combinations_WD3$path[i])
}
combinations_WD4 <- combinations_WD %>%
filter(WD == "4")
for(i in 1:nrow(combinations_WD4)) {
create_simulation(path = combinations_WD4$path[i], template = "template_WD4", h_mn = combinations_WD4$H[i], h_cv = combinations_WD4$V[i],
LAI = combinations_WD4$L[i], ft_h = combinations_WD4$F[i])
}
for(i in 1:nrow(combinations_WD4)) {
run_simulation(path = combinations_WD4$path[i])
}
output_WD <- combinations_WD$path %>%
purrr:: map_df(load_output)
output_combined_WD <- combinations_WD %>%
left_join(output_WD, by = "path")
output_combined_WD %>%
select(F, totPs, H, V, L, WD) %>%
ggplot(aes(F, totPs)) +
geom_point(aes(colour = as.factor(WD))) +
geom_line(aes(colour = as.factor(WD))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "photosynthesis", x = "FT height", y = "Gross photosynthesis", colour = "Wet or Dry")
#wet and dry
H <- c(15)
V <- c(0.10, 0.25)
L <- c(2.916, 4.402, 5.485)
F <- c(1.99, 1.50, 1.00, 0.50, 0.01)
WD <- c(0, 1, 2, 3, 4)
combinations_WD <- expand_grid(H, V, L, F, WD) %>%
mutate(path = sprintf("simulations_WD/H%s_V%s_L%s_F%s_WD%s", H, V, L, F, WD))
combinations_WD0 <- combinations_WD %>%
filter(WD == "0")
for(i in 1:nrow(combinations_WD0)) {
create_simulation(path = combinations_WD0$path[i], template = "template_WD0", h_mn = combinations_WD0$H[i], h_cv = combinations_WD0$V[i],
LAI = combinations_WD0$L[i], ft_h = combinations_WD0$F[i])
}
for(i in 1:nrow(combinations_WD0)) {
run_simulation(path = combinations_WD0$path[i])
}
combinations_WD1 <- combinations_WD %>%
filter(WD == "1")
for(i in 1:nrow(combinations_WD1)) {
create_simulation(path = combinations_WD1$path[i], template = "template_WD1", h_mn = combinations_WD1$H[i], h_cv = combinations_WD1$V[i],
LAI = combinations_WD1$L[i], ft_h = combinations_WD1$F[i])
}
for(i in 1:nrow(combinations_WD1)) {
run_simulation(path = combinations_WD1$path[i])
}
combinations_WD2 <- combinations_WD %>%
filter(WD == "2")
for(i in 1:nrow(combinations_WD2)) {
create_simulation(path = combinations_WD2$path[i], template = "template_WD2", h_mn = combinations_WD2$H[i], h_cv = combinations_WD2$V[i],
LAI = combinations_WD2$L[i], ft_h = combinations_WD2$F[i])
}
for(i in 1:nrow(combinations_WD2)) {
run_simulation(path = combinations_WD2$path[i])
}
combinations_WD3 <- combinations_WD %>%
filter(WD == "3")
for(i in 1:nrow(combinations_WD3)) {
create_simulation(path = combinations_WD3$path[i], template = "template_WD3", h_mn = combinations_WD3$H[i], h_cv = combinations_WD3$V[i],
LAI = combinations_WD3$L[i], ft_h = combinations_WD3$F[i])
}
for(i in 1:nrow(combinations_WD3)) {
run_simulation(path = combinations_WD3$path[i])
}
combinations_WD4 <- combinations_WD %>%
filter(WD == "4")
for(i in 1:nrow(combinations_WD4)) {
create_simulation(path = combinations_WD4$path[i], template = "template_WD4", h_mn = combinations_WD4$H[i], h_cv = combinations_WD4$V[i],
LAI = combinations_WD4$L[i], ft_h = combinations_WD4$F[i])
}
for(i in 1:nrow(combinations_WD4)) {
run_simulation(path = combinations_WD4$path[i])
}
output_WD <- combinations_WD$path %>%
purrr:: map_df(load_output)
output_combined_WD <- combinations_WD %>%
left_join(output_WD, by = "path")
output_combined_WD %>%
select(F, totPs, H, V, L, WD) %>%
ggplot(aes(F, totPs)) +
geom_point(aes(colour = as.factor(WD))) +
geom_line(aes(colour = as.factor(WD))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "photosynthesis", x = "FT height", y = "Gross photosynthesis", colour = "Wet or Dry")
S <- c(1, 2, 3)
combinations_WD <- expand_grid(H, V, L, F, WD, S) %>%
mutate(path = sprintf("simulations_WD/H%s_V%s_L%s_F%s_WD%s_S%s", H, V, L, F, WD, S))
combinations_WD0 <- combinations_WD %>%
filter(WD == "0")
for(i in 1:nrow(combinations_WD0)) {
create_simulation(path = combinations_WD0$path[i], template = "template_WD0", h_mn = combinations_WD0$H[i], h_cv = combinations_WD0$V[i],
LAI = combinations_WD0$L[i], ft_h = combinations_WD0$F[i])
}
for(i in 1:nrow(combinations_WD0)) {
run_simulation(path = combinations_WD0$path[i])
}
combinations_WD1 <- combinations_WD %>%
filter(WD == "1")
for(i in 1:nrow(combinations_WD1)) {
create_simulation(path = combinations_WD1$path[i], template = "template_WD1", h_mn = combinations_WD1$H[i], h_cv = combinations_WD1$V[i],
LAI = combinations_WD1$L[i], ft_h = combinations_WD1$F[i])
}
for(i in 1:nrow(combinations_WD1)) {
run_simulation(path = combinations_WD1$path[i])
}
combinations_WD2 <- combinations_WD %>%
filter(WD == "2")
for(i in 1:nrow(combinations_WD2)) {
create_simulation(path = combinations_WD2$path[i], template = "template_WD2", h_mn = combinations_WD2$H[i], h_cv = combinations_WD2$V[i],
LAI = combinations_WD2$L[i], ft_h = combinations_WD2$F[i])
}
for(i in 1:nrow(combinations_WD2)) {
run_simulation(path = combinations_WD2$path[i])
}
combinations_WD3 <- combinations_WD %>%
filter(WD == "3")
for(i in 1:nrow(combinations_WD3)) {
create_simulation(path = combinations_WD3$path[i], template = "template_WD3", h_mn = combinations_WD3$H[i], h_cv = combinations_WD3$V[i],
LAI = combinations_WD3$L[i], ft_h = combinations_WD3$F[i])
}
for(i in 1:nrow(combinations_WD3)) {
run_simulation(path = combinations_WD3$path[i])
}
combinations_WD4 <- combinations_WD %>%
filter(WD == "4")
for(i in 1:nrow(combinations_WD4)) {
create_simulation(path = combinations_WD4$path[i], template = "template_WD4", h_mn = combinations_WD4$H[i], h_cv = combinations_WD4$V[i],
LAI = combinations_WD4$L[i], ft_h = combinations_WD4$F[i])
}
for(i in 1:nrow(combinations_WD4)) {
run_simulation(path = combinations_WD4$path[i])
}
output_WD <- combinations_WD$path %>%
purrr:: map_df(load_output)
output_combined_WD <- combinations_WD %>%
left_join(output_WD, by = "path")
A <- aggregate(output_combined_WD$totPs, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
A <- rename(A, totPs = x)
B <- aggregate(output_combined_WD$absPAR, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
B <- rename(B, absPAR = x)
C <- aggregate(output_combined_WD$absNIR, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
C <- rename(C, absNIR = x)
D <- aggregate(output_combined_WD$absTherm, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
D <- rename(D, absTherm = x)
E <- aggregate(output_combined_WD$netPs, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
E <- rename(E, netPs = x)
F <- aggregate(output_combined_WD$totRf, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
F <- rename(F, totRF = x)
G <- aggregate(output_combined_WD$totLE1, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
G <- rename(G, totLE1 = x)
H <- aggregate(output_combined_WD$totLE2, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
H <- rename(H, totLE2 = x)
I <- aggregate(output_combined_WD$totH, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
I <- rename(I, totH = x)
absPAR <- B$absPAR
absNIR <- C$absNIR
absTherm <- D$absTherm
netPs <- E$netPs
totRF <- F$totRF
totLE1 <- G$totLE1
totLE2 <- H$totLE2
totH <- I$totH
path <- output_combined_WD$path
mn_outputs_WD <- cbind(path, A, absPAR, absNIR, absTherm, netPs, totRF, totLE1, totLE2, totH)
mn_outputs_WD
mn_outputs_WD %>%
select(F, totPs, H, V, L, WD) %>%
ggplot(aes(F, totPs)) +
geom_point(aes(colour = as.factor(WD))) +
geom_line(aes(colour = as.factor(WD))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "photosynthesis", x = "FT height", y = "Gross photosynthesis", colour = "Wet or Dry")
H <- c(15)
V <- c(0.10, 0.25)
L <- c(2.916, 4.402, 5.485)
F <- c(1.99, 1.50, 1.00, 0.50, 0.01)
WD <- c(0, 1, 2, 3, 4)
S <- c(1, 2, 3)
combinations_WD <- expand_grid(H, V, L, F, WD, S) %>%
mutate(path = sprintf("simulations_WD/H%s_V%s_L%s_F%s_WD%s_S%s", H, V, L, F, WD, S))
combinations_WD0 <- combinations_WD %>%
filter(WD == "0")
for(i in 1:nrow(combinations_WD0)) {
create_simulation(path = combinations_WD0$path[i], template = "template_WD0", h_mn = combinations_WD0$H[i], h_cv = combinations_WD0$V[i],
LAI = combinations_WD0$L[i], ft_h = combinations_WD0$F[i])
}
for(i in 1:nrow(combinations_WD0)) {
run_simulation(path = combinations_WD0$path[i])
}
combinations_WD1 <- combinations_WD %>%
filter(WD == "1")
for(i in 1:nrow(combinations_WD1)) {
create_simulation(path = combinations_WD1$path[i], template = "template_WD1", h_mn = combinations_WD1$H[i], h_cv = combinations_WD1$V[i],
LAI = combinations_WD1$L[i], ft_h = combinations_WD1$F[i])
}
for(i in 1:nrow(combinations_WD1)) {
run_simulation(path = combinations_WD1$path[i])
}
combinations_WD2 <- combinations_WD %>%
filter(WD == "2")
for(i in 1:nrow(combinations_WD2)) {
create_simulation(path = combinations_WD2$path[i], template = "template_WD2", h_mn = combinations_WD2$H[i], h_cv = combinations_WD2$V[i],
LAI = combinations_WD2$L[i], ft_h = combinations_WD2$F[i])
}
for(i in 1:nrow(combinations_WD2)) {
run_simulation(path = combinations_WD2$path[i])
}
combinations_WD3 <- combinations_WD %>%
filter(WD == "3")
for(i in 1:nrow(combinations_WD3)) {
create_simulation(path = combinations_WD3$path[i], template = "template_WD3", h_mn = combinations_WD3$H[i], h_cv = combinations_WD3$V[i],
LAI = combinations_WD3$L[i], ft_h = combinations_WD3$F[i])
}
for(i in 1:nrow(combinations_WD3)) {
run_simulation(path = combinations_WD3$path[i])
}
combinations_WD4 <- combinations_WD %>%
filter(WD == "4")
for(i in 1:nrow(combinations_WD4)) {
create_simulation(path = combinations_WD4$path[i], template = "template_WD4", h_mn = combinations_WD4$H[i], h_cv = combinations_WD4$V[i],
LAI = combinations_WD4$L[i], ft_h = combinations_WD4$F[i])
}
for(i in 1:nrow(combinations_WD4)) {
run_simulation(path = combinations_WD4$path[i])
}
output_WD <- combinations_WD$path %>%
purrr:: map_df(load_output)
output_combined_WD <- combinations_WD %>%
left_join(output_WD, by = "path")
A <- aggregate(output_combined_WD$totPs, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
A <- rename(A, totPs = x)
B <- aggregate(output_combined_WD$absPAR, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
B <- rename(B, absPAR = x)
C <- aggregate(output_combined_WD$absNIR, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
C <- rename(C, absNIR = x)
D <- aggregate(output_combined_WD$absTherm, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
D <- rename(D, absTherm = x)
E <- aggregate(output_combined_WD$netPs, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
E <- rename(E, netPs = x)
F <- aggregate(output_combined_WD$totRf, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
F <- rename(F, totRF = x)
G <- aggregate(output_combined_WD$totLE1, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
G <- rename(G, totLE1 = x)
H <- aggregate(output_combined_WD$totLE2, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
H <- rename(H, totLE2 = x)
I <- aggregate(output_combined_WD$totH, by=list(H=output_combined_WD$H, V=output_combined_WD$V, L=output_combined_WD$L, F=output_combined_WD$F, WD=output_combined_WD$WD),data=output_combined_WD,FUN=mean)
I <- rename(I, totH = x)
absPAR <- B$absPAR
absNIR <- C$absNIR
absTherm <- D$absTherm
netPs <- E$netPs
totRF <- F$totRF
totLE1 <- G$totLE1
totLE2 <- H$totLE2
totH <- I$totH
path <- output_combined_WD$path
mn_outputs_WD <- cbind(path, A, absPAR, absNIR, absTherm, netPs, totRF, totLE1, totLE2, totH)
mn_outputs_WD %>%
select(F, totPs, H, V, L, WD) %>%
ggplot(aes(F, totPs)) +
geom_point(aes(colour = as.factor(WD))) +
geom_line(aes(colour = as.factor(WD))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "photosynthesis", x = "FT height", y = "Gross photosynthesis", colour = "Wet or Dry")
library(Maeswrap)
library(rgl)
library(tidyverse)
#for the average one with everything
H <- c(15)
V <- c(0.00, 0.10, 0.25, 0.50)
L <- c(0.494, 1.429, 2.616, 4.159, 5.07)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
WD <- c(0, 1)
S <- c(1, 2, 3)
combinations_A <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations_A/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
library(Maeswrap)
library(rgl)
library(tidyverse)
#for the average one with everything
H <- c(15)
V <- c(0.00, 0.10, 0.25, 0.50)
L <- c(0.466, 1.488, 2.916, 4.402, 5.485)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
WD <- c(0, 1)
S <- c(1, 2, 3)
View(combinations)
combinations_A <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations_A/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
View(combinations_A)
for(i in 1:nrow(combinations_A)) {
create_simulation(path = combinations_A$path[i], template = "template_A", h_mn = combinations_A$H[i], h_cv = combinations_A$V[i],
LAI = combinations_A$L[i], ft_h = combinations_A$F[i], seed = combinations_A$S[i])
}
for(i in 1:nrow(combinations_A)) {
run_simulation(path = combinations_A$path[i])
}
output_A <- combinations_A$path %>%
purrr:: map_df(load_output)
output_combined_A <- combinations_A %>%
left_join(output_A, by = "path")
mn_outputs_A <- cbind(path, A, absPAR, absNIR, absTherm, netPs, totRF, totLE1, totLE2, totH)
A <- aggregate(output_combined_A$totPs, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
A <- rename(A, totPs = x)
B <- aggregate(output_combined_A$absPAR, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
B <- rename(B, absPAR = x)
C <- aggregate(output_combined_A$absNIR, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
C <- rename(C, absNIR = x)
D <- aggregate(output_combined_A$absTherm, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
D <- rename(D, absTherm = x)
E <- aggregate(output_combined_A$netPs, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
E <- rename(E, netPs = x)
F <- aggregate(output_combined_A$totRf, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
F <- rename(F, totRF = x)
G <- aggregate(output_combined_A$totLE1, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
G <- rename(G, totLE1 = x)
H <- aggregate(output_combined_A$totLE2, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
H <- rename(H, totLE2 = x)
I <- aggregate(output_combined_A$totH, by=list(H=output_combined_A$H, V=output_combined_A$V, L=output_combined_A$L, F=output_combined_A$F),data=output_combined_A,FUN=mean)
I <- rename(I, totH = x)
absPAR <- B$absPAR
absNIR <- C$absNIR
absTherm <- D$absTherm
netPs <- E$netPs
totRF <- F$totRF
totLE1 <- G$totLE1
totLE2 <- H$totLE2
totH <- I$totH
path <- output_combined_A$path
mn_outputs_A <- cbind(path, A, absPAR, absNIR, absTherm, netPs, totRF, totLE1, totLE2, totH)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
names <- as_labeller(
c(`0` = "V 0", `0.1` = "V 0.1", `0.25` = "V 0.25", `0.5` = "V 0.5", `0.75` = "V 0.75",
`0.466` = "LAI 0.494", `1.488`= "LAI 1.429", `2.916`= "LAI 2.616", `4.402`= "LAI 4.159", `5.485`= "LAI 5.07")
)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
library(Maeswrap)
library(rgl)
library(tidyverse)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
names <- as_labeller(
c(`0` = "V 0", `0.1` = "V 0.1", `0.25` = "V 0.25", `0.5` = "V 0.5", `0.75` = "V 0.75",
`0.466` = "LAI 0.467", `1.488`= "LAI 1.349", `2.916`= "LAI 2.917", `4.402`= "LAI 4.485", `5.485`= "LAI 5.395")
)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
mn_outputs_WD %>%
select(F, totPs, H, V, L, WD) %>%
ggplot(aes(F, totPs)) +
geom_point(aes(colour = as.factor(WD))) +
geom_line(aes(colour = as.factor(WD))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "photosynthesis", x = "FT height", y = "Gross photosynthesis", colour = "Wet or Dry")
library(Maeswrap)
library(rgl)
library(tidyverse)
library(Maeswrap)
library(rgl)
library(tidyverse)
names <- as_labeller(
c(`0` = "V 0", `0.1` = "V 0.1", `0.25` = "V 0.25", `0.5` = "V 0.5", `0.75` = "V 0.75",
`0.466` = "LAI 0.467", `1.488`= "LAI 1.349", `2.916`= "LAI 2.917", `4.402`= "LAI 4.485", `5.485`= "LAI 5.395")
)
#average
mn_outputs_A %>%
select(F, absPAR, H, V, L) %>%
ggplot(aes(F, absPAR)) +
geom_point(aes(colour = as.factor(H))) +
geom_line(aes(colour = as.factor(H))) +
facet_grid(rows = vars(V), cols = vars(L), labeller = names) +
labs(title = "PAR", x = "FT height", y = "Absorbed PAR", colour = "Height")
View(mn_outputs_A)
library(Maeswrap)
library(rgl)
library(tidyverse)
combinations <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
#for the average one with everything
H <- c(15)
V <- c(0.00, 0.10, 0.25, 0.50)
L <- c(0.466, 1.488, 2.916, 4.402, 5.485)
F <- c(1.99, 1.85, 1.75, 1.60, 1.50, 1.35, 1.25, 1.15, 1.05, 1.00,
0.95, 0.85, 0.75, 0.65, 0.50, 0.40, 0.25, 0.15, 0.01)
WD <- c(0, 1)
S <- c(1, 2, 3)
combinations <- expand_grid(H, V, L, F, S) %>%
mutate(path = sprintf("simulations/H%s_V%s_L%s_F%s_S%s", H, V, L, F, S))
create_simulation(path = combinations$path[1], template = "template", h_mn = combinations$H[1], h_cv = combinations$V[1],
LAI = combinations$L[1], ft_h = combinations$F[1], seed = combinations$S[1])
run_simulation(path = combinations$path[1])
